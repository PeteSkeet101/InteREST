<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sysevent_script_action">
    <sysevent_script_action action="INSERT_OR_UPDATE">
        <active>true</active>
        <condition_script/>
        <description/>
        <event_name>x_653938_interest.InteREST_incident_open</event_name>
        <name>interest open incident</name>
        <order>100</order>
        <script><![CDATA[gs.info('PS: running script action');

try {
    var r = new sn_ws.RESTMessageV2('');
    r.setEndpoint(event.parm1+'/api/now/table/incident?sysparm_fields=number');
    r.setHttpMethod("post");
    r.setBasicAuth("pete", "Int3rn3t@)@!");
	r.setRequestHeader('Content-Type','application/json');
	
	var sd = current.short_description;
	gs.info('PS: short description is '+sd);
	r.setRequestBody('{"short_description":"'+current.short_description+'",' +'"description":"'+current.description+'",' +'"correlation_id":"'+current.number+'"}');

	
    var response = r.execute();
    var responseBody = response.getBody();
	gs.info('AS line 15 '+response.getErrorMessage());
    var json = responseBody;
    var obj = JSON.parse(json); //define JSON parsing for the response JSON file to decode
    var foundNumber = obj.result.number; //decoded dev2 newly created incident 
	gs.info('PS foundNumber is : '+ foundNumber);
	
    current.correlation_id = foundNumber;
	current.update;
    gs.info("The generated sysid from Dev1 instance is :  " + foundNumber); //log sys_id		
    var httpStatus = response.getStatusCode();
} catch (ex) {
    gs.info('script action interest open incident app gave error: ' + ex.message);
}]]></script>
        <synchronous>false</synchronous>
        <sys_class_name>sysevent_script_action</sys_class_name>
        <sys_created_by>pete</sys_created_by>
        <sys_created_on>2023-03-20 18:24:43</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>329491c09775e9103f5e318c1253af24</sys_id>
        <sys_mod_count>34</sys_mod_count>
        <sys_name>interest open incident</sys_name>
        <sys_overrides/>
        <sys_package display_value="Interest" source="x_653938_interest">836d672e97ad25103f5e318c1253af3d</sys_package>
        <sys_policy/>
        <sys_scope display_value="Interest">836d672e97ad25103f5e318c1253af3d</sys_scope>
        <sys_update_name>sysevent_script_action_329491c09775e9103f5e318c1253af24</sys_update_name>
        <sys_updated_by>pete</sys_updated_by>
        <sys_updated_on>2023-03-22 15:09:15</sys_updated_on>
    </sysevent_script_action>
</record_update>
